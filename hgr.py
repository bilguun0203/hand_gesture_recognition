import cv2
import numpy as np
import copy
import math
import time
import csv
from sklearn.neighbors import KNeighborsClassifier
import pyautogui
from sklearn.decomposition import PCA

# start point/total width
cap_region_x_begin = 0.5
# start point/total width
cap_region_y_end = 0.8
# Binary threshold
threshold = 60
# 1st GaussianBlur parameter
blur_val_1 = 11
# 2nd GaussianBlur parameter
blur_val_2 = 3
# Captured background image
bgImg = np.zeros((480, 640), np.uint8)
# Is background captured
isBgCaptured = False
#
sample = 1
capture = 0
# csvfile
csvfile = open('sample-'+str(sample)+'.csv', 'w', newline='')
csv_wr = csv.writer(csvfile, delimiter='\t', quotechar='|', quoting=csv.QUOTE_MINIMAL)
csv_wr.writerow(['â„–', 'label', 'x1', 'y1', 'x2', 'y2', 'x3', 'y3', 'x4', 'y4', 'x5', 'y5', 'x6', 'y6', 'x7', 'y7', 'a_x1', 'a_y1', 'a_x2', 'a_y2', 'a_x3', 'a_y3', 'a_x4', 'a_y4', 'filename'])

maxdist = 25

# tdata = [
# [0,102,165,87,115,6,1,187,148,0,179,57,167,10,0,0,0,0,0,0,0,0],
# [0,139,219,82,174,0,232,58,229,36,99,156,213,5,0,0,0,0,0,0,0,0],
# [61,0,30,0,198,86,0,84,195,154,92,13,0,23,0,0,0,0,0,0,0,0],
# [89,12,132,129,54,0,0,52,23,12,27,88,201,121,0,0,0,0,0,0,0,0],
# [6,22,28,129,0,41,76,1,102,10,48,0,89,108,0,0,0,0,0,0,0,0],
# [0,35,100,11,43,2,17,240,45,1,84,240,51,0,0,0,0,0,0,0,0,0],
# [0,361,70,0,12,37,59,1,19,27,108,16,98,361,0,0,0,0,0,0,0,0],
# [33,0,93,17,67,0,114,356,0,15,14,368,82,6,0,0,0,0,0,0,0,0],
# [9,74,110,226,31,0,0,29,2,8,44,228,85,8,0,0,0,0,0,0,0,0],
# [96,112,38,112,0,14,18,91,11,77,27,0,84,10,0,0,0,0,0,0,0,0],
# [68,0,14,110,114,103,110,28,0,62,29,144,10,4,0,0,0,0,0,0,0,0],
# [106,256,0,62,116,85,28,256,49,0,10,9,98,19,0,0,0,0,0,0,0,0],
# [10,360,12,10,105,29,61,0,107,356,113,80,0,55,0,0,0,0,0,0,0,0],
# [10,0,119,293,94,0,0,47,108,348,20,353,114,62,0,0,0,0,0,0,0,0],
# [5,15,101,17,55,250,116,71,116,244,0,64,56,0,0,0,0,0,0,0,0,0],
# [0,70,110,67,97,122,27,116,99,19,2,7,58,0,0,0,0,0,0,0,0,0],
# [100,22,54,0,111,72,4,9,0,62,108,126,27,111,0,0,0,0,0,0,0,0],
# [9,8,30,254,0,49,97,23,105,64,57,0,109,250,0,0,0,0,0,0,0,0],
# [90,51,5,359,79,17,98,367,101,291,0,23,38,0,0,0,0,0,0,0,0,0],
# [0,171,293,26,294,122,309,74,143,188,261,0,216,12,0,0,0,0,0,0,0,0],
# [0,216,178,25,224,0,5,341,262,16,274,124,286,77,0,0,0,0,0,0,0,0],
# [45,43,101,0,165,68,2,249,159,127,143,25,0,133,0,0,0,0,0,0,0,0],
# [86,177,178,119,43,56,135,0,173,46,67,15,0,171,0,0,0,0,0,0,0,0],
# [78,0,38,27,296,184,11,57,25,134,296,99,0,81,0,0,0,0,0,0,0,0],
# [129,16,7,128,78,0,29,21,0,70,301,304,300,172,0,0,0,0,0,0,0,0],
# [171,71,18,130,0,66,133,21,42,17,175,191,82,0,0,0,0,0,0,0,0,0],
# [95,0,39,133,0,65,153,45,6,113,40,18,165,147,0,0,0,0,0,0,0,0],
# [113,36,2,25,92,176,54,0,0,73,19,172,93,12,0,0,0,0,0,0,0,0],
# [140,356,58,0,101,12,9,24,37,361,0,44,114,35,0,0,0,0,0,0,0,0],
# [2,350,63,0,99,348,55,1,0,42,110,96,107,6,0,0,0,0,0,0,0,0],
# [116,14,87,173,0,33,29,172,88,2,108,110,65,0,0,0,0,0,0,0,0,0],
# [49,163,110,163,56,3,0,13,5,92,106,17,37,0,0,0,0,0,0,0,0,0],
# [3,19,66,2,113,18,113,350,49,0,20,354,0,50,0,0,0,0,0,0,0,0],
# [0,26,25,0,14,102,77,340,49,0,175,337,98,8,0,0,0,0,0,0,0,0],
# [107,17,45,145,30,0,0,18,119,153,98,7,18,101,0,0,0,0,0,0,0,0],
# [0,73,91,5,32,130,35,0,3,21,146,153,139,35,0,0,0,0,0,0,0,0],
# [68,352,0,67,82,0,170,348,39,1,139,34,3,22,0,0,0,0,0,0,0,0],
# [83,0,133,20,0,72,138,334,47,337,147,77,16,15,0,0,0,0,0,0,0,0],
# [35,0,141,82,0,70,6,21,106,154,92,5,135,32,0,0,0,0,0,0,0,0],
# [133,23,0,41,170,358,147,61,40,5,64,360,92,0,0,0,0,0,0,0,0,0],
# [1,25,88,0,139,34,36,0,150,185,66,188,0,76,0,0,0,0,0,0,0,0],
# [245,88,205,26,53,313,93,10,0,313,0,189,118,0,0,0,0,0,0,0,0,0],
# [0,281,166,0,224,22,119,48,257,90,76,294,254,121,0,0,0,0,0,0,0,0],
# [0,252,223,75,124,0,55,78,188,26,36,328,234,161,0,0,0,0,0,0,0,0],
# [0,126,47,0,243,175,10,41,239,292,87,2,175,73,0,0,0,0,0,0,0,0],
# [73,6,109,0,68,8,256,189,0,73,255,288,54,148,0,0,0,0,0,0,0,0],
# [130,0,183,42,57,20,0,86,265,296,31,157,273,174,0,0,0,0,0,0,0,0],
# [0,78,165,322,105,0,184,24,56,317,20,32,3,51,0,0,0,0,0,0,0,0],
# [177,317,60,0,9,21,16,144,92,317,0,34,168,23,0,0,0,0,0,0,0,0],
# [232,128,136,0,184,319,0,121,228,98,19,25,206,28,0,0,0,0,0,0,0,0],
# [207,85,0,185,221,66,8,294,58,245,230,0,155,23,0,0,0,0,0,0,0,0],
# [80,169,160,100,185,3,179,81,172,0,0,167,98,43,0,0,0,0,0,0,0,0],
# [205,165,123,27,3,0,0,15,203,277,58,117,142,46,0,0,0,0,0,0,0,0],
# [0,14,222,153,177,179,67,108,136,36,2,0,226,173,0,0,0,0,0,0,0,0],
# [18,2,8,197,73,195,110,116,35,4,30,0,0,110,0,0,0,0,0,0,0,0],
# [4,228,0,110,11,273,29,0,0,103,107,105,81,284,0,0,0,0,0,0,0,0],
# [92,366,2,243,0,102,21,0,32,0,5,366,106,96,0,0,0,0,0,0,0,0],
# [157,359,155,335,69,359,158,347,0,98,56,0,98,82,0,0,0,0,0,0,0,0],
# [11,135,60,0,142,283,99,91,80,284,1,111,0,100,0,0,0,0,0,0,0,0],
# [98,97,99,101,57,187,113,185,65,0,0,103,23,155,0,0,0,0,0,0,0,0],
# [26,195,0,138,19,0,91,195,91,84,6,8,94,135,0,0,0,0,0,0,0,0],
# [43,273,0,123,112,271,94,80,9,10,14,0,26,0,0,0,0,0,0,0,0,0],
# [99,88,22,0,34,370,125,367,91,62,10,5,0,116,0,0,0,0,0,0,0,0],
# [97,363,101,72,12,0,21,366,105,335,0,123,4,16,0,0,0,0,0,0,0,0],
# [0,130,4,9,14,0,15,297,99,121,80,295,98,77,0,0,0,0,0,0,0,0],
# [7,0,96,82,98,104,77,177,0,136,18,180,96,132,0,0,0,0,0,0,0,0],
# [95,142,81,178,98,93,23,0,0,127,9,11,13,172,0,0,0,0,0,0,0,0],
# [103,282,89,69,31,286,0,118,16,0,6,7,0,111,0,0,0,0,0,0,0,0],
# [8,371,0,109,97,365,22,0,10,10,87,63,15,1,0,0,0,0,0,0,0,0],
# [120,52,152,172,114,55,79,87,0,175,215,141,261,0,0,0,0,0,0,0,0,0],
# [292,0,158,71,131,106,165,64,38,356,0,289,280,126,0,0,0,0,0,0,0,0],
# [131,128,128,4,0,108,1,270,137,0,150,3,27,68,0,0,0,0,0,0,0,0],
# [184,0,158,148,0,193,172,128,122,175,55,90,168,0,0,0,0,0,0,0,0,0],
# [212,159,185,17,153,152,217,45,118,142,287,147,0,0,0,0,0,0,0,0,0,0],
# [297,319,168,23,298,179,91,147,0,0,300,194,200,50,0,0,0,0,0,0,0,0],
# [83,156,165,44,2,24,186,256,8,0,0,9,189,68,0,0,0,0,0,0,0,0],
# [99,122,1,0,211,139,138,139,183,54,158,27,0,16,0,0,0,0,0,0,0,0],
# [9,225,36,0,93,234,21,4,124,144,0,150,8,66,0,0,0,0,0,0,0,0],
# [0,120,123,145,10,283,122,368,38,0,35,368,23,4,0,0,0,0,0,0,0,0],
# [65,0,11,128,3,370,83,371,53,0,148,140,0,309,0,0,0,0,0,0,0,0],
# [147,153,7,128,53,0,140,169,145,143,0,246,84,241,0,0,0,0,0,0,0,0],
# [24,197,132,183,0,132,128,126,45,220,75,0,124,222,0,0,0,0,0,0,0,0],
# [131,117,0,121,133,254,125,363,87,0,77,1,54,364,0,0,0,0,0,0,0,0],
# [56,5,61,0,0,129,70,1,115,98,108,369,191,366,0,0,0,0,0,0,0,0],
# [53,6,113,106,60,0,69,1,142,225,44,207,0,138,0,0,0,0,0,0,0,0],
# [15,197,35,0,0,158,21,10,118,118,132,234,45,236,0,0,0,0,0,0,0,0],
# [115,109,58,372,0,129,39,0,105,81,147,367,27,7,0,0,0,0,0,0,0,0],
# [114,106,112,78,91,358,0,122,21,0,109,70,7,361,0,0,0,0,0,0,0,0],
# [116,123,20,0,18,190,111,100,0,141,94,201,113,157,0,0,0,0,0,0,0,0],
# [0,137,42,362,23,0,13,12,132,356,110,83,117,108,0,0,0,0,0,0,0,0],
# [0,143,116,146,114,111,23,0,112,218,105,88,25,198,0,0,0,0,0,0,0,0],
# [88,97,0,191,269,9,16,317,219,223,259,0,98,88,0,0,0,0,0,0,0,0],
# [288,6,194,153,75,51,41,138,59,319,272,0,0,299,0,0,0,0,0,0,0,0],
# [277,3,254,0,80,343,206,222,56,137,198,233,0,318,0,0,0,0,0,0,0,0],
# [246,238,245,331,0,0,251,245,260,280,10,212,141,108,0,0,0,0,0,0,0,0],
# [258,292,278,273,0,0,189,37,232,55,79,158,189,292,0,0,0,0,0,0,0,0],
# [0,33,1,0,287,237,263,297,210,55,116,202,251,107,0,0,0,0,0,0,0,0],
# [0,186,16,347,115,355,48,0,0,170,179,185,30,1,0,0,0,0,0,0,0,0],
# [80,2,43,249,0,164,194,317,104,326,157,138,94,0,0,0,0,0,0,0,0,0],
# [166,237,153,344,5,0,166,171,157,146,44,344,0,245,0,0,0,0,0,0,0,0],
# [91,55,3,229,0,141,108,41,233,41,111,39,187,0,0,0,0,0,0,0,0,0],
# [50,72,66,57,94,132,153,0,200,44,121,118,0,133,0,0,0,0,0,0,0,0],
# [147,65,0,58,219,175,216,277,0,48,124,43,38,0,0,0,0,0,0,0,0,0],
# [187,148,233,135,128,138,103,128,0,52,38,0,155,54,0,0,0,0,0,0,0,0],
# [87,0,77,184,119,115,0,18,111,137,16,184,1,7,0,0,0,0,0,0,0,0],
# [0,9,120,117,9,241,89,4,80,0,76,261,12,256,0,0,0,0,0,0,0,0],
# [87,12,0,369,116,116,116,108,85,375,12,1,21,0,19,19,0,0,0,0,0,0],
# [126,314,133,356,85,97,0,107,12,47,58,0,46,371,0,0,0,0,0,0,0,0],
# [58,1,59,273,123,273,0,124,84,99,46,0,9,41,0,0,0,0,0,0,0,0],
# [0,95,0,124,11,157,94,159,9,30,90,121,52,0,0,0,0,0,0,0,0,0],
# [11,164,93,120,0,6,90,142,93,92,76,0,81,167,0,0,0,0,0,0,0,0],
# [77,0,93,91,2,7,104,268,14,176,34,270,0,26,0,0,0,0,0,0,0,0],
# [0,351,88,95,88,81,85,354,78,1,3,12,68,0,0,0,0,0,0,0,0,0],
# [89,342,86,354,94,0,103,3,29,11,118,82,0,355,0,0,0,0,0,0,0,0],
# [0,23,103,88,1,12,78,0,15,270,75,270,98,129,23,4,0,0,0,0,0,0],
# [92,122,0,8,17,177,73,170,76,0,96,92,90,136,0,0,0,0,0,0,0,0],
# [2,2,11,156,91,97,76,0,87,134,0,17,74,166,0,0,0,0,0,0,0,0],
# [0,24,82,270,73,2,16,271,63,0,1,11,89,86,0,0,0,0,0,0,0,0],
# [88,88,2,12,88,76,84,358,66,0,0,23,2,359,0,0,0,0,0,0,0,0],
# [162,133,0,164,195,0,54,91,115,156,252,68,31,117,0,0,0,0,0,0,0,0],
# [0,361,67,361,248,0,0,284,313,51,115,118,132,100,0,0,0,0,0,0,0,0],
# [195,48,38,85,16,112,196,61,132,0,2,302,0,145,0,0,0,0,0,0,0,0],
# [203,70,143,0,21,103,52,185,114,145,122,139,0,163,0,0,0,0,0,0,0,0],
# [192,57,171,166,206,172,143,157,0,75,40,0,299,159,0,0,0,0,0,0,0,0],
# [0,77,2,88,55,0,197,95,291,353,164,63,300,246,0,0,0,0,0,0,0,0],
# [198,115,210,164,0,83,164,65,0,71,208,300,65,0,0,0,0,0,0,0,0,0],
# [77,0,0,65,187,179,184,119,110,181,122,190,154,192,0,0,0,0,0,0,0,0],
# [134,252,25,228,21,33,0,172,115,135,85,0,26,23,0,0,0,0,0,0,0,0],
# [8,212,163,369,88,0,27,44,78,371,0,160,31,37,0,0,0,0,0,0,0,0],
# [118,359,115,144,0,157,5,205,41,363,6,33,101,0,0,0,0,0,0,0,0,0],
# [117,155,31,222,109,209,19,21,0,159,95,0,10,195,0,0,0,0,0,0,0,0],
# [0,220,116,184,133,152,105,0,4,7,0,209,72,220,0,0,0,0,0,0,0,0],
# [0,5,15,355,8,0,96,357,98,3,137,146,2,269,0,0,0,0,0,0,0,0],
# [3,286,0,355,117,5,35,0,80,360,157,153,159,145,0,0,0,0,0,0,0,0],
# [152,155,141,180,116,3,106,0,96,224,26,7,0,221,0,0,0,0,0,0,0,0],
# [117,146,116,167,0,13,103,0,113,188,102,219,14,214,0,0,0,0,0,0,0,0],
# [96,0,0,15,106,115,114,358,4,203,30,360,11,248,0,0,0,0,0,0,0,0],
# [4,369,0,25,89,368,121,111,100,2,2,9,90,0,27,7,0,0,0,0,0,0],
# [111,170,0,13,22,193,14,150,120,120,97,0,97,198,0,0,0,0,0,0,0,0],
# [135,366,0,36,90,0,3,21,102,2,49,369,124,111,0,0,0,0,0,0,0,0],
# [0,23,126,123,126,176,102,2,39,215,116,225,89,0,0,0,0,0,0,0,0,0],
# [200,256,299,88,0,326,0,245,3,241,194,0,47,326,0,0,0,0,0,0,0,0],
# [219,0,266,34,0,285,201,2,79,299,159,205,53,123,0,0,0,0,0,0,0,0],
# [0,331,283,98,55,331,279,85,15,205,161,228,173,0,0,0,0,0,0,0,0,0],
# [89,0,313,236,263,304,76,1,258,103,305,311,0,116,0,0,0,0,0,0,0,0],
# [59,0,277,178,140,227,277,271,279,184,0,57,242,129,0,0,0,0,0,0,0,0],
# [285,319,0,97,110,0,191,283,224,301,293,237,260,157,0,0,0,0,0,0,0,0],
# [149,216,162,175,154,11,90,302,10,0,1,301,0,158,34,16,0,0,0,0,0,0],
# [79,0,0,216,136,314,139,227,9,42,40,316,135,174,0,0,0,0,0,0,0,0],
# [129,323,166,219,168,211,0,12,34,321,158,0,172,190,0,0,0,0,0,0,0,0],
# [124,0,213,13,244,50,0,170,193,105,116,0,2,275,42,9,0,0,0,0,0,0],
# [208,7,244,43,244,49,0,168,80,174,194,105,113,0,48,8,0,0,0,0,0,0],
# [232,227,29,146,0,49,145,40,111,14,24,0,232,145,0,0,10,45,0,0,0,0],
# [32,0,144,171,169,171,0,42,124,49,194,162,16,139,0,0,1,42,0,0,0,0],
# [118,0,44,5,140,93,0,91,9,117,46,180,113,168,33,0,0,35,0,0,0,0],
# [131,86,107,1,0,74,46,0,131,76,63,249,127,250,27,0,0,22,0,0,0,0],
# [42,0,92,7,121,344,125,85,0,59,35,343,124,74,24,0,0,12,0,0,0,0],
# [160,366,127,64,60,27,160,352,69,367,103,0,0,113,0,0,0,0,0,0,0,0],
# [84,264,94,0,147,260,119,66,55,22,52,25,0,109,20,0,0,43,0,0,0,0],
# [0,102,55,18,97,0,123,109,117,68,74,187,131,184,21,0,0,38,0,0,0,0],
# [69,186,149,137,130,0,63,6,0,93,132,185,155,86,33,0,0,34,0,0,0,0],
# [129,0,0,89,136,4,66,8,154,86,146,285,75,285,35,0,0,32,0,0,0,0],
# [152,79,117,0,64,12,129,2,67,360,153,354,0,93,31,0,0,32,0,0,0,0],
# [158,83,130,363,67,10,44,366,158,75,129,0,0,91,33,0,0,32,0,0,0,0],
# [117,0,69,264,130,264,63,10,155,82,0,97,127,2,30,0,0,32,0,0,0,0],
# [120,188,143,134,0,89,126,0,154,82,65,190,66,5,55,3,33,0,0,31,0,0],
# [144,63,60,363,147,353,108,0,0,89,52,12,55,10,26,0,0,29,0,0,0,0],
# [137,62,50,12,138,251,0,93,139,104,75,251,105,0,24,0,0,31,0,0,0,0],
# [66,158,131,120,0,93,119,157,51,10,103,0,133,64,26,0,0,31,0,0,0,0],
# [144,171,236,25,279,91,92,184,198,152,0,182,90,0,63,17,0,0,0,0,0,0],
# [27,343,111,0,300,39,100,1,302,50,250,1,0,254,62,1,0,0,0,0,0,0],
# [162,0,3,322,169,0,220,44,0,163,173,2,24,8,56,0,0,1,0,0,0,0],
# [79,185,253,71,0,176,124,171,176,144,50,0,205,8,65,10,0,0,0,0,0,0],
# [52,0,301,171,154,43,37,214,40,2,0,69,294,235,0,0,11,68,0,0,0,0],
# [300,308,150,32,302,198,0,73,200,75,36,0,39,213,0,0,12,67,0,0,0,0],
# [35,215,209,249,190,82,150,41,0,71,47,0,205,105,0,0,9,65,0,0,0,0],
# [210,143,189,99,207,216,51,0,30,204,144,48,0,64,0,0,9,65,0,0,0,0],
# [124,223,130,206,161,110,43,8,57,225,121,0,0,118,34,0,0,31,0,0,0,0],
# [125,3,0,95,163,98,52,355,118,0,131,356,51,2,33,0,0,20,0,0,0,0],
# [118,0,174,345,48,3,91,349,0,94,52,0,162,85,32,0,0,26,0,0,0,0],
# [48,12,161,98,118,0,143,224,127,4,0,131,70,224,30,0,0,45,0,0,0,0],
# [175,232,75,18,0,122,140,0,93,236,55,198,169,97,32,0,0,39,0,0,0,0],
# [131,1,196,353,158,86,120,0,70,30,112,357,0,135,25,0,0,43,0,0,0,0],
# [136,0,159,86,91,364,165,361,0,142,146,366,78,35,0,0,0,0,0,0,0,0],
# [151,93,58,212,70,25,123,0,0,130,153,180,144,219,28,0,0,49,0,0,0,0],
# [157,0,71,10,165,207,82,206,179,156,0,124,184,94,41,0,0,45,0,0,0,0],
# [110,363,179,83,152,3,71,20,196,360,0,121,141,0,35,0,0,41,0,0,0,0],
# [181,85,0,114,70,16,169,355,150,0,95,358,181,77,33,0,0,38,0,0,0,0],
# [68,8,155,180,150,0,0,108,77,187,169,145,176,86,38,0,0,40,0,0,0,0],
# [108,358,0,118,192,347,192,359,140,0,64,19,172,74,31,0,0,39,0,0,0,0],
# [1,133,172,121,94,213,0,124,139,0,162,213,58,16,32,0,0,46,0,0,0,0],
# [198,173,0,184,79,54,273,86,215,0,273,75,13,319,48,9,0,0,0,0,0,0],
# [218,0,78,295,202,139,73,47,0,280,79,39,267,27,66,0,0,18,0,0,0,0],
# [297,69,53,37,224,174,209,0,70,322,0,295,229,169,73,0,0,6,0,0,0,0],
# [271,260,251,120,172,51,39,0,0,53,272,156,42,192,0,0,22,69,0,0,0,0],
# [194,74,297,312,175,55,306,235,96,241,0,100,63,0,0,0,27,72,0,0,0,0],
# [0,99,65,0,296,195,49,249,247,110,295,297,184,50,0,0,16,76,0,0,0,0],
# [191,117,24,26,146,0,0,175,175,346,89,346,192,144,38,0,0,43,0,0,0,0],
# [62,46,128,0,188,117,191,328,0,184,205,214,66,40,31,0,0,54,0,0,0,0],
# [241,218,190,0,232,347,242,130,0,208,143,348,60,42,43,0,0,71,0,0,0,0],
# [2,234,159,0,0,150,95,40,208,65,167,0,198,19,15,11,0,0,20,29,0,0],
# [211,49,206,85,94,40,165,0,0,148,199,20,52,169,13,13,0,0,15,32,0,0],
# [233,163,91,0,37,14,0,91,6,43,234,243,235,184,34,0,12,13,0,33,0,0],
# [102,148,20,29,95,0,231,179,259,168,265,143,0,90,35,0,11,11,0,32,0,0],
# [4,159,99,322,0,14,24,323,141,68,48,0,99,21,49,35,29,0,0,14,0,0],
# [72,226,43,0,89,23,6,207,0,11,125,75,91,176,47,45,29,0,0,6,0,0],
# [109,209,86,7,50,0,6,25,113,45,0,153,19,189,52,0,27,0,0,8,0,0],
# [107,352,8,31,23,368,76,0,104,23,40,2,0,137,50,0,25,13,0,21,0,0],
# [103,250,49,256,2,27,103,259,101,26,60,0,0,142,49,0,25,6,0,14,0,0],
# [39,0,122,221,8,179,24,204,81,0,0,37,126,33,56,15,29,0,0,15,0,0],
# [96,16,90,212,29,211,129,56,0,148,2,18,51,0,47,14,26,1,0,0,0,0],
# [127,53,27,282,0,135,0,21,90,12,96,282,47,0,48,13,25,0,0,1,0,0],
# [42,0,115,365,31,365,127,38,8,134,0,26,87,7,51,9,26,0,0,1,0,0],
# [0,26,43,0,118,336,88,4,100,367,44,369,134,36,51,8,26,0,0,4,0,0],
# [123,30,109,253,0,28,53,273,18,135,96,271,41,0,50,8,26,0,0,3,0,0],
# [89,8,108,131,129,44,87,182,28,161,0,23,42,0,50,11,25,0,0,2,0,0],
# [44,0,121,47,89,197,85,12,33,197,0,21,7,139,47,12,25,0,0,1,0,0],
# [0,118,19,293,90,293,113,42,42,0,79,9,0,20,43,10,23,0,0,0,0,0],
# [111,35,4,115,0,21,111,370,31,368,77,8,38,0,44,9,23,0,0,1,0,0],
# [76,93,135,203,88,78,293,121,219,0,277,32,0,202,19,24,0,0,24,55,0,0],
# [93,97,97,93,272,31,0,263,200,0,297,116,19,368,36,45,24,17,0,0,0,0],
# [0,67,171,20,113,0,29,48,188,54,0,234,180,113,36,9,0,0,35,42,0,0],
# [34,86,109,166,186,26,132,0,0,163,208,118,211,63,31,45,21,19,0,0,0,0],
# [5,131,0,79,0,67,103,0,36,27,142,180,304,180,38,0,10,18,0,48,0,0],
# [54,20,306,300,52,21,131,0,7,62,0,131,308,189,48,0,17,19,0,48,0,0],
# [64,15,124,199,142,0,0,119,221,115,13,52,228,248,53,0,20,16,0,43,0,0],
# [65,7,123,179,231,196,234,128,137,0,0,103,15,36,49,0,18,11,0,35,0,0],
# [0,35,43,0,123,56,88,13,81,193,92,173,12,190,46,56,30,0,0,20,0,0],
# [13,23,16,20,59,0,82,363,136,65,101,19,0,361,45,64,28,0,0,14,0,0],
# [26,355,5,171,49,0,15,273,0,11,121,54,109,357,53,47,33,6,0,0,0,0],
# [0,18,108,23,104,225,11,174,49,0,148,73,27,225,54,30,32,4,0,0,0,0],
# [0,172,115,229,23,210,2,31,118,47,44,0,88,7,56,1,30,0,0,6,0,0],
# [112,30,78,357,0,43,9,170,70,0,34,4,157,354,52,8,25,0,0,18,0,0],
# [129,347,3,171,68,348,126,33,0,38,90,1,47,0,57,5,29,0,0,19,0,0],
# [123,48,91,7,0,35,11,175,49,0,117,225,56,227,53,6,28,0,0,15,0,0],
# [152,58,62,0,114,18,0,29,152,68,17,180,72,224,56,15,31,0,0,3,0,0],
# [15,162,65,360,0,34,5,26,129,27,56,0,150,361,56,11,29,0,0,4,0,0],
# [0,33,52,359,58,0,166,49,18,162,117,8,139,360,62,12,32,0,0,5,0,0],
# [60,0,28,167,118,10,48,204,0,34,128,222,168,51,59,12,30,0,0,4,0,0],
# [49,0,2,25,103,9,25,168,85,223,0,34,150,47,55,11,29,0,0,4,0,0],
# [126,367,53,0,125,32,40,367,2,25,9,145,0,40,52,11,27,0,0,2,0,0],
# [151,0,239,70,206,14,243,152,44,159,0,239,28,325,10,85,27,23,0,0,0,0],
# [0,299,87,300,241,111,38,131,242,109,234,19,143,0,40,3,0,0,66,25,0,0],
# [0,320,93,325,237,19,143,0,274,69,43,147,278,156,44,56,30,22,0,0,0,0],
# [112,205,273,175,26,11,80,0,154,32,0,79,273,288,7,0,0,44,0,0,0,0],
# [0,122,17,37,11,44,270,293,151,0,287,213,68,5,63,17,0,0,13,56,0,0],
# [288,296,183,0,90,3,142,233,29,38,0,127,300,202,65,0,25,13,0,40,0,0],
# [138,338,52,0,172,82,118,21,38,326,0,29,17,227,67,63,39,0,0,5,0,0],
# [180,329,127,9,102,331,175,67,19,234,0,52,67,0,72,5,37,0,0,15,0,0],
# [203,344,168,11,0,55,90,0,50,267,240,72,111,344,82,15,43,0,0,5,0,0],
# [0,190,249,101,259,59,259,53,92,191,218,0,99,0,60,19,43,0,0,2,64,42],
# [231,49,217,18,2,283,222,82,176,0,92,7,0,178,62,10,37,0,0,2,74,28],
# [101,0,12,40,41,167,198,130,0,90,196,204,47,9,37,0,14,13,0,34,17,73],
# [0,65,148,165,15,25,54,1,103,0,29,141,180,147,38,0,15,8,0,25,11,62],
# [13,12,89,22,56,0,87,311,124,63,15,311,0,93,60,49,44,0,18,6,0,44],
# [61,0,33,213,17,15,133,61,0,103,99,19,96,192,59,43,44,0,18,13,0,48],
# [83,0,126,210,157,43,71,211,0,97,46,19,130,10,68,2,43,3,15,0,0,40],
# [42,25,77,0,0,104,59,344,157,26,142,340,126,2,67,0,40,8,15,14,0,47],
# [133,273,149,29,120,3,0,96,42,22,64,272,77,0,65,0,40,8,16,15,0,43],
# [88,209,40,28,81,0,159,34,0,121,153,208,129,2,70,0,42,15,16,23,0,60],
# [73,182,0,95,88,0,48,16,165,44,132,11,130,167,71,12,49,0,24,0,0,34],
# [0,101,76,283,47,19,87,0,163,40,144,283,129,8,68,10,46,0,21,3,0,35],
# [63,355,49,13,0,97,141,354,45,17,107,0,161,32,68,8,47,0,22,3,0,37],
# [0,107,38,23,80,0,123,7,157,39,49,373,130,371,65,12,44,0,18,4,0,41],
# [146,29,37,23,135,304,61,305,0,104,39,20,80,0,65,13,43,0,19,5,0,41],
# [75,184,0,101,35,20,76,0,152,39,130,184,117,7,62,11,40,0,17,5,0,38],
# [125,10,69,182,122,182,41,16,158,43,82,0,0,96,66,10,45,0,21,1,0,35],
# [123,254,79,0,58,255,0,95,39,17,119,7,152,38,63,9,42,0,20,2,0,35],
# [37,19,76,0,29,366,115,7,0,95,110,353,146,34,60,8,40,0,17,1,0,33],
# [3,335,246,0,0,221,124,7,288,137,303,59,289,135,69,23,52,1,0,0,69,51],
# [41,9,3,257,212,35,164,0,198,139,0,158,222,82,74,20,51,1,0,0,69,51],
# [167,20,28,20,189,63,124,0,182,110,0,166,57,177,60,16,42,0,0,6,66,39],
# [168,0,214,28,0,162,222,109,229,64,71,5,85,163,60,17,41,0,0,0,65,40],
# [67,0,130,2,54,178,18,22,0,82,0,72,287,190,52,0,13,3,0,31,18,86],
# [0,79,134,0,19,27,31,183,68,0,286,364,298,232,53,0,16,7,0,34,11,90],
# [76,0,23,28,246,297,0,88,150,1,235,129,34,202,59,0,19,7,0,35,11,95],
# [215,214,34,176,24,19,219,130,0,71,133,0,68,1,52,0,12,0,0,27,11,81],
# [55,0,0,138,142,69,103,21,81,220,64,0,13,24,45,60,30,0,0,8,0,0],
# [114,361,150,77,0,118,108,26,34,361,65,0,17,14,49,59,30,2,0,0,0,0],
# [0,105,38,0,163,56,160,347,0,102,116,12,77,346,77,47,52,0,20,2,0,46],
# [118,17,163,58,20,22,114,15,65,0,0,134,120,214,73,45,47,0,16,8,0,70],
# [0,134,86,0,161,204,140,9,44,29,174,53,61,204,77,0,46,7,13,6,0,62],
# [109,358,76,3,0,150,192,356,41,43,156,30,125,0,67,0,42,40,12,50,0,108],
# [105,358,0,135,100,0,53,34,158,2,197,34,187,356,84,0,52,8,22,17,0,58],
# [63,195,98,0,0,120,51,25,193,60,162,190,155,12,78,9,52,0,22,3,0,41],
# [38,30,42,23,147,15,118,209,100,0,189,60,0,127,80,16,55,0,25,4,0,47],
# [190,40,177,352,92,351,0,127,192,47,43,26,112,0,77,11,51,0,22,6,0,48],
# [199,53,85,338,0,125,165,337,121,0,197,41,45,24,81,11,54,0,25,4,0,47],
# [150,201,198,59,89,202,0,128,155,15,106,0,43,25,81,13,55,0,24,1,0,41],
# [151,17,86,204,47,21,188,60,0,120,106,0,149,204,78,17,56,0,26,4,0,45],
# [0,123,52,24,155,15,172,352,108,0,88,352,190,55,76,13,54,0,25,4,0,42],
# [184,0,278,163,91,78,277,86,0,309,248,29,81,328,72,63,83,7,42,3,0,0],
# [38,64,253,39,252,97,251,34,0,301,188,0,97,302,125,7,86,5,50,0,0,25],
# [0,69,242,59,194,9,240,56,2,323,255,128,117,0,108,46,89,16,58,0,0,28],
# [275,295,14,49,0,117,80,228,86,0,0,109,171,0,71,0,37,11,0,31,37,100],
# [263,206,158,36,16,195,31,7,253,324,0,67,87,0,20,0,0,33,12,99,0,0],
# [40,22,2,87,280,301,108,0,28,237,0,95,191,13,71,0,30,5,0,29,6,101],
# [203,339,30,28,0,158,162,17,92,0,227,68,112,339,100,30,63,0,28,15,0,68],
# [0,179,239,46,116,0,228,326,55,46,142,328,185,0,100,0,62,1,25,15,0,68],
# [0,183,45,47,130,0,262,62,190,338,119,1,196,11,111,14,72,0,32,7,0,70]
# ]
tdata = [
[19,25,230,110,206,28,105,320,136,0,223,318,0,121,0,0,0,0,0,0,0,0],
[88,317,56,0,11,144,172,31,0,28,173,317,158,17,0,0,0,0,0,0,0,0],
[3,51,56,317,184,24,105,0,20,32,165,322,0,78,0,0,0,0,0,0,0,0],
[126,0,261,296,7,134,269,174,53,20,179,42,0,62,0,0,0,0,0,0,0,0],
[77,7,261,288,0,92,263,189,60,148,115,0,18,37,0,0,0,0,0,0,0,0],
[243,176,50,0,0,127,239,293,175,73,10,42,90,4,0,0,0,0,0,0,0,0],
[188,26,234,165,0,252,55,78,36,328,124,0,226,90,0,0,0,0,0,0,0,0],
[257,90,0,281,166,0,224,22,119,48,76,294,254,121,0,0,0,0,0,0,0,0],
[245,88,96,9,0,313,205,27,0,189,121,0,53,313,0,0,0,0,0,0,0,0],
[0,76,139,34,150,185,36,0,88,0,1,25,66,188,0,0,0,0,0,0,0,0],
[104,0,170,354,0,36,141,30,64,356,150,73,40,0,0,0,0,0,0,0,0,0],
[20,5,135,26,48,149,0,64,126,148,92,0,141,76,0,0,0,0,0,0,0,0],
[138,334,16,15,133,20,47,337,0,72,147,77,83,0,0,0,0,0,0,0,0,0],
[57,0,170,349,141,38,68,353,3,23,0,68,107,6,0,0,0,0,0,0,0,0],
[0,73,139,35,35,0,146,153,32,130,91,5,3,21,0,0,0,0,0,0,0,0],
[0,18,103,13,38,135,30,0,119,153,18,101,52,154,0,0,0,0,0,0,0,0],
[77,340,25,0,98,8,175,337,14,102,0,26,49,0,0,0,0,0,0,0,0,0],
[108,11,113,350,3,19,20,353,54,0,120,25,0,49,0,0,0,0,0,0,0,0],
[37,0,49,163,106,17,5,92,110,163,0,13,56,3,0,0,0,0,0,0,0,0],
[0,41,114,110,121,14,34,172,76,0,92,173,10,23,0,0,0,0,0,0,0,0],
[9,33,104,347,112,5,7,349,62,0,115,95,0,51,0,0,0,0,0,0,0,0],
[9,24,140,356,101,12,37,361,0,44,58,0,114,35,0,0,0,0,0,0,0,0],
[96,15,19,172,2,25,0,73,114,40,92,176,54,0,0,0,0,0,0,0,0,0],
[0,65,153,45,95,0,165,147,39,133,40,18,6,113,0,0,0,0,0,0,0,0],
[175,189,77,0,0,64,171,69,0,114,133,19,31,139,0,0,0,0,0,0,0,0],
[26,30,304,304,10,128,304,172,133,16,0,77,82,0,0,0,0,0,0,0,0,0],
[5,125,293,99,75,0,293,184,0,75,45,144,35,27,0,0,0,0,0,0,0,0],
[152,14,178,128,60,36,86,187,173,55,0,180,108,0,0,0,0,0,0,0,0,0],
[164,80,0,133,101,0,45,43,2,249,158,132,143,25,0,0,0,0,0,0,0,0],
[286,77,5,341,262,16,0,216,178,25,224,0,274,124,0,0,0,0,0,0,0,0],
[294,122,0,171,216,12,290,20,143,188,306,65,261,0,0,0,0,0,0,0,0,0],
[0,23,5,359,101,291,89,46,38,0,98,367,77,13,0,0,0,0,0,0,0,0],
[9,8,30,254,97,23,109,250,105,64,57,0,0,49,0,0,0,0,0,0,0,0],
[111,72,4,9,27,111,100,22,0,62,108,126,54,0,0,0,0,0,0,0,0,0],
[0,70,99,19,97,122,2,7,27,116,110,67,58,0,0,0,0,0,0,0,0,0],
[5,15,55,250,101,17,116,244,56,0,0,64,116,71,0,0,0,0,0,0,0,0],
[0,21,15,366,98,20,103,360,109,75,59,0,114,306,0,0,0,0,0,0,0,0],
[12,10,107,356,105,29,10,360,61,0,113,80,0,55,0,0,0,0,0,0,0,0],
[116,83,67,0,28,254,108,25,10,7,106,254,0,60,0,0,0,0,0,0,0,0],
[68,0,20,123,10,4,117,82,109,144,0,62,110,28,0,0,0,0,0,0,0,0],
[0,27,40,112,86,10,98,112,16,84,2,8,29,0,0,0,0,0,0,0,0,0],
[44,228,2,8,85,8,110,226,9,74,31,0,0,29,0,0,0,0,0,0,0,0],
[74,2,114,364,0,15,14,368,33,0,115,331,93,17,0,0,0,0,0,0,0,0],
[112,22,98,360,19,26,0,360,62,0,106,11,12,36,0,0,0,0,0,0,0,0],
[108,15,88,239,7,27,52,0,21,239,0,42,101,5,0,0,0,0,0,0,0,0],
[54,0,93,97,3,26,102,10,28,128,0,46,82,127,0,0,0,0,0,0,0,0],
[201,120,23,11,27,88,58,0,0,51,132,129,96,16,0,0,0,0,0,0,0,0],
[96,10,206,154,0,75,10,23,31,104,208,86,50,0,0,0,0,0,0,0,0,0],
[231,53,0,144,99,160,187,0,219,86,162,8,213,10,0,0,0,0,0,0,0,0],
[148,0,1,187,179,57,0,102,165,87,115,6,167,10,0,0,0,0,0,0,0,0],
[51,344,12,0,169,159,0,224,160,344,173,237,18,277,0,0,0,0,0,0,0,0],
[104,326,80,2,0,164,157,138,194,317,43,249,94,0,0,0,0,0,0,0,0,0],
[30,1,115,355,179,185,0,178,18,353,48,0,14,337,0,0,0,0,0,0,0,0],
[277,282,0,0,209,41,116,189,286,224,250,93,224,287,0,0,0,0,0,0,0,0],
[258,292,0,0,232,55,79,158,189,292,278,273,189,37,0,0,0,0,0,0,0,0],
[0,0,260,280,10,212,141,108,257,329,249,243,220,333,0,0,0,0,0,0,0,0],
[269,0,57,126,202,225,0,315,80,341,90,100,38,170,0,0,0,0,0,0,0,0],
[286,0,75,46,59,314,194,147,41,132,0,273,0,314,0,0,0,0,0,0,0,0],
[258,0,219,223,0,192,96,91,32,318,268,8,0,318,0,0,0,0,0,0,0,0],
[23,0,13,177,109,98,0,143,116,146,112,218,37,218,0,0,0,0,0,0,0,0],
[23,0,132,356,117,108,0,137,42,362,110,83,13,12,0,0,0,0,0,0,0,0],
[116,123,20,0,18,190,94,201,0,141,113,157,111,100,0,0,0,0,0,0,0,0],
[114,110,91,362,27,0,0,126,7,365,110,78,17,6,0,0,0,0,0,0,0,0],
[36,0,148,364,117,107,0,135,59,369,107,78,5,98,0,0,0,0,0,0,0,0],
[15,197,35,0,118,118,132,234,45,236,0,158,21,10,0,0,0,0,0,0,0,0],
[56,2,39,201,142,223,0,137,113,105,67,226,69,0,0,0,0,0,0,0,0,0],
[59,1,115,97,109,368,0,132,192,365,70,0,0,121,0,0,0,0,0,0,0,0],
[131,116,55,364,83,0,0,128,125,363,133,254,0,114,0,0,0,0,0,0,0,0],
[0,125,126,222,77,0,18,182,131,126,39,212,134,183,0,0,0,0,0,0,0,0],
[146,149,53,0,75,248,7,128,0,246,140,169,91,237,0,0,0,0,0,0,0,0],
[83,370,60,0,149,140,1,327,12,128,3,370,0,299,0,0,0,0,0,0,0,0],
[0,134,38,365,30,0,126,142,13,280,125,365,11,65,0,0,0,0,0,0,0,0],
[126,142,29,0,0,133,94,232,11,223,2,163,10,64,0,0,0,0,0,0,0,0],
[179,45,0,0,218,130,98,115,137,133,154,18,192,137,0,0,0,0,0,0,0,0],
[185,254,5,0,158,38,82,154,188,66,0,17,174,49,0,0,0,0,0,0,0,0],
[2,0,299,327,169,31,300,193,92,156,201,59,0,23,0,0,0,0,0,0,0,0],
[153,152,0,0,287,147,185,17,118,142,217,45,212,159,0,0,0,0,0,0,0,0],
[132,169,180,0,0,193,44,105,165,138,84,197,65,75,0,0,0,0,0,0,0,0],
[1,269,150,2,135,122,27,67,0,107,119,144,135,0,0,0,0,0,0,0,0,0],
[292,0,0,356,161,67,280,126,77,356,0,289,131,106,0,0,0,0,0,0,0,0],
[225,134,261,0,116,54,0,175,152,172,79,87,200,153,0,0,0,0,0,0,0,0],
[8,371,10,8,97,369,87,63,0,109,98,351,19,0,0,0,0,0,0,0,0,0],
[103,282,89,69,9,2,0,114,31,286,20,0,5,10,0,0,0,0,0,0,0,0],
[16,0,95,139,0,125,98,90,13,170,81,175,6,35,0,0,0,0,0,0,0,0],
[18,180,7,0,96,132,0,136,96,82,77,177,98,104,0,0,0,0,0,0,0,0],
[4,9,80,295,99,121,0,130,15,297,98,77,14,0,0,0,0,0,0,0,0,0],
[0,125,21,368,15,0,101,74,97,365,5,10,105,337,0,0,0,0,0,0,0,0],
[34,369,8,8,99,88,125,367,0,115,91,61,15,0,0,0,0,0,0,0,0,0],
[112,271,10,8,98,99,0,124,43,273,20,0,93,75,0,0,0,0,0,0,0,0],
[95,80,16,0,0,122,30,191,95,191,98,131,9,151,0,0,0,0,0,0,0,0],
[99,99,21,151,65,0,113,185,0,103,57,187,34,167,0,0,0,0,0,0,0,0],
[60,0,142,283,11,135,99,91,80,284,0,109,0,97,0,0,0,0,0,0,0,0],
[157,343,51,1,0,99,69,359,98,83,61,0,157,360,0,0,0,0,0,0,0,0],
[106,96,92,366,21,0,0,102,2,243,5,366,32,0,0,0,0,0,0,0,0,0],
[107,105,9,261,29,0,0,106,81,284,4,228,14,285,0,0,0,0,0,0,0,0],
[8,196,18,0,110,114,0,117,73,194,31,0,0,101,0,0,0,0,0,0,0,0],
[131,26,225,168,0,0,66,103,176,173,149,48,220,148,0,0,0,0,0,0,0,0],
[142,46,203,277,0,15,205,165,58,117,123,27,3,0,0,0,0,0,0,0,0,0],
[185,3,0,167,160,100,98,43,80,169,179,81,172,0,0,0,0,0,0,0,0,0],
[230,0,8,294,145,29,217,70,0,185,58,245,166,17,0,0,0,0,0,0,0,0],
[3,8,170,213,161,0,37,321,132,323,0,27,175,190,0,0,0,0,0,0,0,0],
[9,42,139,227,0,216,79,0,136,314,40,316,135,174,0,0,0,0,0,0,0,0],
[10,0,90,302,149,216,154,11,0,158,1,301,162,175,34,16,0,0,0,0,0,0],
[260,157,0,97,285,319,110,0,191,283,293,237,224,301,0,0,0,0,0,0,0,0],
[59,0,242,129,159,237,278,181,0,57,277,271,121,216,0,0,0,0,0,0,0,0],
[0,115,263,303,268,114,81,0,305,310,313,235,239,78,0,0,0,0,0,0,0,0],
[173,0,55,331,281,94,161,228,22,191,0,331,0,232,0,0,0,0,0,0,0,0],
[0,284,266,32,53,122,140,226,208,0,79,297,169,192,0,0,0,0,0,0,0,0],
[194,0,1,243,208,251,299,88,0,326,47,326,169,277,0,0,0,0,0,0,0,0],
[43,223,100,0,0,21,126,120,116,223,126,173,35,203,0,0,0,0,0,0,0,0],
[102,2,135,366,3,21,124,111,49,369,90,0,0,36,0,0,0,0,0,0,0,0],
[120,120,0,13,22,193,97,0,97,198,14,150,111,170,0,0,0,0,0,0,0,0],
[89,368,2,9,100,2,121,111,4,369,0,25,90,0,27,7,0,0,0,0,0,0],
[0,15,114,358,96,0,4,203,106,115,30,360,11,248,0,0,0,0,0,0,0,0],
[17,214,3,8,119,153,106,0,116,188,0,30,105,219,0,0,0,0,0,0,0,0],
[114,0,147,170,0,219,26,4,96,221,152,152,135,186,0,0,0,0,0,0,0,0],
[0,355,117,5,159,145,35,0,80,360,3,286,157,153,0,0,0,0,0,0,0,0],
[1,0,2,279,136,142,96,0,13,351,95,353,0,252,0,0,0,0,0,0,0,0],
[96,0,116,186,0,217,4,9,72,222,133,154,108,2,0,0,0,0,0,0,0,0],
[19,21,109,209,31,222,95,0,0,159,117,155,10,195,0,0,0,0,0,0,0,0],
[41,363,6,33,5,205,101,0,118,359,115,144,0,157,0,0,0,0,0,0,0,0],
[89,0,80,371,0,175,164,369,31,39,9,212,4,138,0,0,0,0,0,0,0,0],
[85,0,47,255,134,252,24,26,0,172,115,135,14,215,0,0,0,0,0,0,0,0],
[154,192,77,0,0,65,187,123,187,179,119,188,172,100,0,0,0,0,0,0,0,0],
[207,300,0,77,192,102,210,164,65,0,202,123,163,65,0,0,0,0,0,0,0,0],
[196,95,277,357,0,82,54,0,299,246,163,63,299,350,0,0,0,0,0,0,0,0],
[40,0,282,171,192,57,183,168,0,75,305,155,143,157,0,0,0,0,0,0,0,0],
[203,70,0,142,143,0,118,142,21,103,52,185,0,185,0,0,0,0,0,0,0,0],
[16,112,195,48,2,302,132,0,38,85,0,145,196,61,0,0,0,0,0,0,0,0],
[132,100,248,0,0,361,313,51,0,284,67,361,115,118,0,0,0,0,0,0,0,0],
[195,0,82,167,162,133,252,68,0,164,47,100,126,152,0,0,0,0,0,0,0,0],
[3,10,84,358,66,0,88,88,2,359,0,19,88,76,0,0,0,0,0,0,0,0],
[82,270,1,11,89,86,73,2,16,271,0,24,63,0,0,0,0,0,0,0,0,0],
[74,0,89,97,0,5,12,168,72,166,85,134,8,150,0,0,0,0,0,0,0,0],
[76,0,77,164,0,8,96,92,17,177,91,131,69,176,0,0,0,0,0,0,0,0],
[103,88,75,270,78,0,1,12,15,270,98,129,0,23,23,4,0,0,0,0,0,0],
[0,355,104,4,86,354,29,11,118,82,89,342,97,0,0,0,0,0,0,0,0,0],
[0,351,78,1,3,12,85,354,88,81,88,95,68,0,0,0,0,0,0,0,0,0],
[75,0,31,270,8,157,0,11,101,268,90,91,15,195,0,0,0,0,0,0,0,0],
[93,120,76,0,0,6,11,164,81,167,93,92,90,142,0,0,0,0,0,0,0,0],
[93,134,9,30,11,157,52,0,0,117,84,95,94,159,0,0,0,0,0,0,0,0],
[61,272,11,40,54,0,86,99,0,114,125,272,7,153,0,0,0,0,0,0,0,0],
[58,0,133,356,12,47,46,371,0,107,85,97,126,314,0,0,0,0,0,0,0,0],
[87,12,0,376,116,112,12,1,85,375,0,363,21,0,19,19,0,0,0,0,0,0],
[12,256,87,2,120,117,0,9,76,261,9,241,76,0,0,0,0,0,0,0,0,0],
[1,7,111,137,87,0,16,184,77,184,0,18,119,115,0,0,0,0,0,0,0,0],
[128,138,0,52,233,135,155,54,38,0,187,148,103,128,0,0,0,0,0,0,0,0],
[38,0,216,277,139,55,219,175,0,53,116,38,151,69,0,0,0,0,0,0,0,0],
[200,44,94,132,0,133,66,57,153,0,121,118,50,72,0,0,0,0,0,0,0,0],
[187,0,0,141,233,46,110,40,3,229,91,55,233,37,0,0,0,0,0,0,0,0],
[60,42,232,347,190,0,0,208,242,130,143,348,241,218,43,0,0,71,0,0,0,0],
[128,0,209,326,0,184,205,214,188,117,65,42,126,338,31,0,0,54,0,0,0,0],
[24,26,175,346,192,144,0,175,146,0,89,346,191,117,38,0,0,43,0,0,0,0],
[247,110,0,99,65,0,295,297,49,249,184,50,296,195,0,0,16,76,0,0,0,0],
[96,241,63,0,304,309,0,100,181,62,306,235,286,316,0,0,27,72,0,0,0,0],
[39,0,271,260,42,192,172,51,272,156,0,53,251,120,0,0,22,69,0,0,0,0],
[0,267,297,69,53,37,209,0,226,172,70,322,0,322,73,0,0,6,0,0,0,0],
[0,295,218,0,77,41,202,139,267,27,78,295,0,265,66,0,0,18,0,0,0,0],
[273,83,0,319,79,54,0,184,216,0,199,173,27,319,48,9,0,0,0,0,0,0],
[0,130,139,0,170,80,171,134,57,16,93,213,161,213,32,0,0,46,0,0,0,0],
[64,19,108,358,0,118,140,0,192,359,172,74,192,347,31,0,0,39,0,0,0,0],
[0,108,168,148,150,0,68,8,176,86,77,187,153,184,38,0,0,40,0,0,0,0],
[181,80,172,354,70,16,0,114,150,0,95,358,155,359,33,0,0,38,0,0,0,0],
[0,121,196,360,152,3,71,20,110,363,179,83,141,0,35,0,0,41,0,0,0,0],
[71,10,179,156,0,124,157,0,184,94,82,206,165,207,41,0,0,45,0,0,0,0],
[153,180,123,0,0,130,58,212,70,25,151,93,144,219,28,0,0,49,0,0,0,0],
[91,364,78,35,0,142,136,0,165,361,159,86,146,366,0,0,0,0,0,0,0,0],
[120,0,196,353,0,135,158,86,70,30,112,357,131,1,25,0,0,43,0,0,0,0],
[140,0,55,198,175,232,0,122,169,97,75,18,93,236,32,0,0,39,0,0,0,0],
[70,221,123,0,0,128,161,89,48,9,143,221,161,108,30,0,0,45,0,0,0,0],
[49,4,174,348,162,87,120,2,0,96,91,352,110,0,32,0,0,26,0,0,0,0],
[51,0,131,353,163,91,0,92,122,0,52,353,163,105,33,0,0,20,0,0,0,0],
[0,118,161,110,43,8,130,206,121,0,57,225,124,223,34,0,0,31,0,0,0,0],
[189,99,0,64,30,204,207,216,144,48,51,0,210,143,0,0,9,65,0,0,0,0],
[207,110,0,71,35,215,209,249,150,41,47,0,197,91,0,0,9,65,0,0,0,0],
[300,308,0,73,200,75,39,213,302,198,36,0,150,32,0,0,12,67,0,0,0,0],
[300,230,0,68,37,212,154,41,43,0,301,169,281,240,0,0,11,68,0,0,0,0],
[205,8,0,176,176,144,50,0,253,71,124,171,79,185,65,10,0,0,0,0,0,0],
[221,48,3,322,24,8,0,163,171,1,162,0,219,38,56,0,0,1,0,0,0,0],
[0,343,250,1,100,1,0,254,300,42,55,343,111,0,62,1,0,0,0,0,0,0],
[90,0,198,152,0,182,279,91,144,171,236,25,92,184,63,17,0,0,0,0,0,0],
[119,157,103,0,0,93,131,120,51,10,133,64,66,158,26,0,0,31,0,0,0,0],
[0,93,105,0,138,251,139,104,50,12,75,251,137,62,24,0,0,31,0,0,0,0],
[148,348,53,11,144,63,0,89,108,0,60,363,147,363,26,0,0,29,0,0,0,0],
[120,188,66,5,0,89,143,134,126,0,65,190,154,82,55,3,33,0,0,31,0,0],
[127,2,130,264,0,97,155,82,63,10,69,264,117,0,30,0,0,32,0,0,0,0],
[122,0,44,367,0,92,130,364,158,80,67,11,132,1,33,0,0,32,0,0,0,0],
[0,93,67,360,129,2,153,354,64,12,152,79,117,0,31,0,0,32,0,0,0,0],
[129,0,0,89,146,285,154,86,66,8,75,285,136,4,35,0,0,32,0,0,0,0],
[130,0,155,86,63,6,0,93,149,137,69,186,132,185,33,0,0,34,0,0,0,0],
[123,109,55,18,0,102,131,184,97,0,117,68,74,187,21,0,0,38,0,0,0,0],
[89,0,147,261,0,110,84,265,119,67,54,24,98,0,20,0,0,43,0,0,0,0],
[160,364,103,0,0,113,69,367,127,64,60,27,160,345,0,0,0,0,0,0,0,0],
[0,59,35,343,124,74,92,7,121,344,42,0,125,85,24,0,0,12,0,0,0,0],
[43,1,63,250,107,2,0,75,131,82,127,251,52,0,27,0,0,22,0,0,0,0],
[113,168,44,5,9,117,118,0,140,93,46,180,0,91,33,0,0,35,0,0,0,0],
[16,139,191,163,108,33,32,0,0,42,139,66,153,171,0,0,1,42,0,0,0,0],
[232,145,24,0,29,146,232,227,0,49,145,40,111,14,0,0,10,45,0,0,0,0],
[113,0,244,45,0,174,194,105,208,7,80,174,0,161,48,8,0,0,0,0,0,0],
[0,169,244,52,118,0,2,274,193,104,213,13,245,44,42,9,0,0,0,0,0,0],
[0,55,50,267,240,72,203,344,90,0,168,11,111,344,82,15,43,0,0,5,0,0],
[0,52,19,234,180,329,67,0,127,9,102,331,175,67,72,5,37,0,0,15,0,0],
[0,29,38,326,172,82,52,0,118,21,138,338,17,227,67,63,39,0,0,5,0,0],
[142,233,29,38,183,0,288,296,0,127,90,3,300,202,65,0,25,13,0,40,0,0],
[151,0,287,293,0,122,68,5,13,43,287,213,253,293,63,17,0,0,13,56,0,0],
[112,205,26,11,273,288,154,32,273,175,0,79,80,0,7,0,0,44,0,0,0,0],
[0,320,237,19,43,147,278,156,143,0,93,325,274,69,44,56,30,22,0,0,0,0],
[143,0,0,299,38,131,222,3,241,110,87,300,249,42,40,3,0,0,66,25,0,0],
[243,152,206,14,0,239,28,325,239,70,151,0,44,159,10,85,27,23,0,0,0,0],
[0,28,125,367,139,47,7,145,51,0,38,367,100,10,52,11,27,0,0,2,0,0],
[47,0,24,168,148,47,0,29,115,223,102,9,51,223,55,11,29,0,0,4,0,0],
[28,167,118,10,0,34,48,204,168,51,128,222,60,0,59,12,30,0,0,4,0,0],
[58,0,52,359,166,49,18,162,0,33,139,360,117,8,62,12,32,0,0,5,0,0],
[14,162,55,0,64,360,0,32,148,45,149,361,107,8,56,11,29,0,0,4,0,0],
[0,29,49,224,114,18,17,180,62,0,120,224,152,63,56,15,31,0,0,3,0,0],
[11,175,0,35,123,48,117,225,91,7,49,0,56,227,53,6,28,0,0,15,0,0],
[129,347,47,0,0,38,3,171,126,33,68,348,90,1,57,5,29,0,0,19,0,0],
[157,354,0,43,9,170,70,0,78,357,112,30,34,4,52,8,25,0,0,18,0,0],
[46,0,20,205,120,47,116,229,3,31,0,167,89,7,56,1,30,0,0,6,0,0],
[104,225,0,18,148,73,27,225,49,0,108,23,11,174,54,30,32,4,0,0,0,0],
[5,160,70,0,26,344,141,70,0,0,109,346,15,262,53,47,33,6,0,0,0,0],
[136,65,0,361,15,21,82,363,101,19,64,0,54,0,45,64,28,0,0,14,0,0],
[12,190,88,13,92,173,0,35,123,56,43,0,81,193,46,56,30,0,0,20,0,0],
[65,7,231,196,0,103,123,179,137,0,15,36,234,128,49,0,18,11,0,35,0,0],
[221,115,64,15,0,119,124,199,228,248,142,0,13,52,53,0,20,16,0,43,0,0],
[4,136,308,300,133,0,55,20,310,189,9,62,0,127,48,0,17,19,0,48,0,0],
[303,194,36,27,4,131,103,0,141,180,0,71,305,121,38,0,10,18,0,48,0,0],
[34,86,208,118,132,0,0,163,109,166,186,26,211,63,31,45,21,19,0,0,0,0],
[0,234,188,54,0,67,180,113,113,0,171,20,29,48,36,9,0,0,35,42,0,0],
[260,18,19,368,95,95,297,116,0,263,200,0,291,52,36,45,24,17,0,0,0,0],
[277,32,135,203,0,202,84,83,289,148,219,0,298,81,19,24,0,0,24,55,0,0],
[111,35,111,370,0,21,31,368,4,115,38,0,77,8,44,9,23,0,0,1,0,0],
[0,20,90,293,113,42,0,118,19,293,79,9,42,0,43,10,23,0,0,0,0,0],
[85,12,7,139,0,21,121,47,89,197,44,0,33,197,47,12,25,0,0,1,0,0],
[129,42,87,180,0,21,22,147,54,0,108,129,41,182,50,11,25,0,0,2,0,0],
[97,269,41,0,18,135,134,38,0,28,53,273,90,5,50,8,26,0,0,3,0,0],
[0,26,100,367,134,36,43,0,44,369,88,4,118,336,51,8,26,0,0,4,0,0],
[42,0,115,365,127,38,8,134,0,26,31,365,87,7,51,9,26,0,0,1,0,0],
[0,21,27,282,127,53,0,135,96,282,47,0,90,12,48,13,25,0,0,1,0,0],
[0,148,51,0,129,56,90,212,2,18,29,211,96,16,47,14,26,1,0,0,0,0],
[29,210,39,0,126,33,10,184,0,37,122,221,81,0,56,15,29,0,0,15,0,0],
[0,142,69,0,103,256,2,27,49,256,101,26,34,0,49,0,25,6,0,14,0,0],
[104,23,107,367,8,31,0,136,67,0,23,368,108,320,50,0,25,13,0,21,0,0],
[109,209,50,0,0,153,113,45,19,189,6,25,86,7,52,0,27,0,0,8,0,0],
[80,209,45,0,127,75,11,224,1,11,0,159,91,23,47,45,29,0,0,6,0,0],
[24,323,0,14,141,68,4,159,99,322,99,21,48,0,49,35,29,0,0,14,0,0],
[264,152,0,90,102,148,38,14,95,0,239,177,7,38,35,0,11,11,0,32,0,0],
[91,0,234,243,0,91,233,163,6,43,37,14,235,184,34,0,12,13,0,33,0,0],
[206,85,94,40,52,169,165,0,0,148,211,49,199,20,13,13,0,0,15,32,0,0],
[95,40,2,234,211,45,161,0,0,149,207,78,198,18,15,11,0,0,20,29,0,0],
[235,337,45,46,262,61,0,182,121,0,196,10,145,337,111,14,72,0,32,7,0,70],
[239,46,0,179,228,326,55,46,116,0,142,328,185,0,100,0,62,1,25,15,0,68],
[0,120,151,17,149,204,47,21,106,0,188,60,86,204,78,17,56,0,26,4,0,45],
[198,59,0,128,150,201,43,25,155,15,106,0,89,202,81,13,55,0,24,1,0,41],
[45,28,165,341,198,49,0,128,100,0,85,341,153,9,81,11,54,0,25,4,0,47],
[95,0,92,354,0,130,191,47,177,355,43,29,147,8,77,11,51,0,22,6,0,48],
[189,60,41,25,86,209,0,127,100,0,151,209,147,15,80,16,55,0,25,4,0,47],
[155,12,63,195,98,0,0,120,162,190,193,60,51,25,78,9,52,0,22,3,0,41],
[0,135,158,2,187,356,53,34,197,34,100,0,105,358,84,0,52,8,22,17,0,58],
[109,358,76,3,0,150,156,30,192,356,41,43,125,0,67,0,42,40,12,50,0,108],
[86,0,0,134,161,204,174,53,61,204,140,9,44,29,77,0,46,7,13,6,0,62],
[163,58,20,22,134,213,0,134,65,0,116,16,62,219,73,45,47,0,16,8,0,70],
[203,339,92,0,0,158,227,68,162,17,30,28,112,339,100,30,63,0,28,15,0,68],
[163,66,77,356,20,16,116,22,0,113,67,0,160,357,77,47,52,0,20,2,0,46],
[150,77,34,361,17,14,0,118,114,361,65,0,108,26,49,59,30,2,0,0,0,0],
[60,0,99,219,142,69,0,138,27,222,13,24,103,21,45,60,30,0,0,8,0,0],
[0,71,219,130,133,0,34,176,68,1,24,19,215,214,52,0,12,0,0,27,11,81],
[0,88,235,129,150,1,34,202,246,297,23,28,76,0,59,0,19,7,0,35,11,95],
[0,79,298,232,286,364,134,0,31,183,19,27,68,0,53,0,16,7,0,34,11,90],
[0,77,287,190,67,0,121,193,42,176,18,22,130,2,52,0,13,3,0,31,18,86],
[222,109,71,5,0,162,214,28,168,0,85,163,229,64,60,17,41,0,0,0,65,40],
[167,20,28,20,182,110,0,166,124,0,57,177,189,63,60,16,42,0,0,6,66,39],
[41,9,222,82,3,257,164,0,198,139,0,158,212,35,74,20,51,1,0,0,69,51],
[39,22,274,334,27,237,191,13,0,93,108,0,291,237,71,0,30,5,0,29,6,101],
[246,0,3,335,289,136,124,7,309,82,0,221,298,35,69,23,52,1,0,0,69,51],
[146,34,110,353,37,19,0,95,29,366,76,0,115,7,60,8,40,0,17,1,0,33],
[152,38,123,254,39,17,0,95,119,7,58,255,79,0,63,9,42,0,20,2,0,35],
[0,96,158,43,41,16,122,182,125,10,69,182,82,0,66,10,45,0,21,1,0,35],
[117,7,75,184,35,20,0,101,130,184,152,39,76,0,62,11,40,0,17,5,0,38],
[0,104,80,0,135,304,157,40,38,21,61,305,124,8,65,13,43,0,19,5,0,41],
[123,7,130,371,38,23,157,39,0,107,80,0,49,373,65,12,44,0,18,4,0,41],
[127,6,141,357,0,100,47,19,63,358,161,35,88,0,68,8,47,0,22,3,0,37],
[87,0,76,283,0,101,163,40,144,283,47,19,129,8,68,10,46,0,21,3,0,35],
[132,11,0,95,130,167,88,0,48,16,165,44,73,182,71,12,49,0,24,0,0,34],
[253,324,0,67,158,36,16,195,263,206,87,0,31,7,20,0,0,33,12,99,0,0],
[129,2,0,121,153,208,40,28,81,0,159,34,88,209,70,0,42,15,16,23,0,60],
[42,22,64,272,149,29,0,96,133,273,77,0,120,3,65,0,40,8,16,15,0,43],
[77,0,142,340,0,104,157,26,42,25,59,344,126,2,67,0,40,8,15,14,0,47],
[157,43,0,97,71,211,83,0,126,210,46,19,130,10,68,2,43,3,15,0,0,40],
[108,147,74,0,0,97,133,55,33,206,90,206,17,9,59,43,44,0,18,13,0,48],
[89,22,87,311,0,93,13,12,15,311,124,63,56,0,60,49,44,0,18,6,0,44],
[164,165,15,25,29,141,103,0,180,129,0,65,54,1,38,0,15,8,0,25,11,62],
[196,204,47,9,0,90,101,0,41,167,12,40,198,130,37,0,14,13,0,34,17,73],
[92,7,2,283,231,49,0,178,176,0,222,82,217,18,62,10,37,0,0,2,74,28],
[249,113,99,11,0,201,198,0,244,27,92,203,259,68,60,19,43,0,0,2,64,42],
[85,0,270,328,0,114,79,228,171,0,14,49,283,230,71,0,37,11,0,31,37,100],
[32,69,226,9,104,324,287,128,0,323,149,0,274,58,108,46,89,16,58,0,0,28],
[252,97,0,301,143,0,38,64,211,0,97,302,251,36,125,7,86,5,50,0,0,25],
[184,0,0,309,278,163,91,78,248,29,81,328,277,86,72,63,83,7,42,3,0,0],
[0,123,52,24,88,352,190,55,108,0,172,352,155,15,76,13,54,0,25,4,0,42]
]
# tdata = np.load("dump")
tlabel = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]
neigh = KNeighborsClassifier(n_neighbors=10)
neigh.fit(tdata, tlabel)

def threshold_change(thr):
    print("[INFO] Changed threshold to " + str(thr))


def max_by_col(li, col):
    maxx = 0
    try:
        maxx = max(li, key=lambda x: x[col])[col]
    except Exception:
        pass
    return maxx


def min_by_col(li, col):
    minn = 0
    try:
        minn = min(li, key=lambda x: x[col])[col]
    except Exception:
        pass
    return minn


def save_data(cap, coords1, coords2, wr, f, img):
    while len(coords1) < 7:
        coords1.append([0, 0])
    while len(coords2) < 4:
        coords2.append([0, 0])

    filename = 'captures/capture-no_' + str(cap) + '-f_' + str(f) + '.bmp'
    coords = [
        cap,
        f,
        coords1[0][0],
        coords1[0][1],
        coords1[1][0],
        coords1[1][1],
        coords1[2][0],
        coords1[2][1],
        coords1[3][0],
        coords1[3][1],
        coords1[4][0],
        coords1[4][1],
        coords1[5][0],
        coords1[5][1],
        coords1[6][0],
        coords1[6][1],
        coords2[0][0],
        coords2[0][1],
        coords2[1][0],
        coords2[1][1],
        coords2[2][0],
        coords2[2][1],
        coords2[3][0],
        coords2[3][1]
    ]
    coords = [int(x) for x in coords]
    coords.append(filename)
    wr.writerow(coords)
    csvfile.flush()
    cv2.imwrite(filename, img)
    print("[INFO] Row added" + str(cap))


def remove_bg(image):
    global bgImg, isBgCaptured
    if isBgCaptured:
        return cv2.absdiff(bgImg, image)
    return None


def calculate_fingers(res, hull_p, drawing):  # -> finished bool, cnt: finger count
    global maxdist
    #  convexity defect
    hull = cv2.convexHull(res, returnPoints=False)
    fangle = []
    center = None
    if len(hull) > 3:
        # finger tips
        dots = []
        for dot in hull_p:
            dots.append([dot[0][0], dot[0][1]])
        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 10, 1.0)
        dots = np.float32(dots)
        k = 7
        if len(dots) < k:
            k = len(dots)
        rect, label, center = cv2.kmeans(dots, k, None, criteria, 10, cv2.KMEANS_PP_CENTERS)
        for item in center:
            cv2.circle(drawing, (item[0], item[1]), 8, [211, 84, 200], -1)
        # finger angle
        defects = cv2.convexityDefects(res, hull)
        if type(defects) != type(None):  # avoid crashing.   (BUG not found)

            cnt = 0
            for i in range(defects.shape[0]):  # calculate the angle
                s, e, f, d = defects[i][0]
                start = tuple(res[s][0])
                end = tuple(res[e][0])
                far = tuple(res[f][0])
                a = math.sqrt((end[0] - start[0]) ** 2 + (end[1] - start[1]) ** 2)
                b = math.sqrt((far[0] - start[0]) ** 2 + (far[1] - start[1]) ** 2)
                c = math.sqrt((end[0] - far[0]) ** 2 + (end[1] - far[1]) ** 2)
                angle = math.acos((b ** 2 + c ** 2 - a ** 2) / (2 * b * c))  # cosine theorem
                if angle <= math.pi / 2:  # angle less than 90 degree, treat as fingers
                    cnt += 1
                    fangle.append([far[0], far[1]])
                    cv2.circle(drawing, far, 8, [211, 84, 0], -1)
            return True, cnt, center, fangle
    return False, 0, None, None


# Camera
camera = cv2.VideoCapture(0)
camera.set(10, 200)
# Binary threshold trackbar
cv2.namedWindow('trackbar')
cv2.createTrackbar('trh1', 'trackbar', threshold, 255, threshold_change)
# last_time = time.time()
finger_point_pos = None
finger_angle_pos = None

while camera.isOpened():
    ret, frame = camera.read()
    threshold = cv2.getTrackbarPos('trh1', 'trackbar')
    frame = cv2.bilateralFilter(frame, 5, 50, 100)
    frame = cv2.flip(frame, 1)
    cv2.rectangle(frame, (int(cap_region_x_begin * frame.shape[1]), 0),
                  (frame.shape[1], int(cap_region_y_end * frame.shape[0])), (255, 0, 0), 2)
    cropped_img = frame[0:int(cap_region_y_end * frame.shape[0]),
                  int(cap_region_x_begin * frame.shape[1]):frame.shape[1]]

    cv2.imshow('original', frame)

    if isBgCaptured == 1:
        img = remove_bg(cropped_img)
        if img is not None:
            gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
            blur = cv2.GaussianBlur(gray, (blur_val_1, blur_val_1), 0)

            ret, thresh = cv2.threshold(blur, threshold, 255, cv2.THRESH_BINARY)

            thresh = cv2.GaussianBlur(thresh, (blur_val_2, blur_val_2), 0)

            # cv2.imshow('blur', blur)
            # cv2.imshow('thresh', thresh)
            cv2.imshow('blur thresh', thresh)

            thresh1 = copy.deepcopy(thresh)
            im2, contours, hierarchy = cv2.findContours(thresh1, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)
            length = len(contours)
            maxArea = -1
            drawing = np.zeros(img.shape, np.uint8)
            if length > 0:
                for i in range(length):  # find the biggest contour (according to area)
                    temp = contours[i]
                    area = cv2.contourArea(temp)
                    if area > maxArea:
                        maxArea = area
                        ci = i

                res = contours[ci]
                hull = cv2.convexHull(res)
                drawing = np.zeros(img.shape, np.uint8)
                cv2.drawContours(drawing, [res], 0, (0, 255, 0), 2)
                cv2.drawContours(drawing, [hull], 0, (0, 0, 255), 3)

                isFinishCal, cnt, finger_point_pos, finger_angle_pos = calculate_fingers(res, hull, drawing)

                if finger_point_pos is not None and finger_angle_pos is not None:
                    min_point_f = [min_by_col(finger_point_pos, 0), min_by_col(finger_point_pos, 1)]
                    min_point_a = [min_by_col(finger_angle_pos, 0), min_by_col(finger_angle_pos, 1)]
                    max_point_f = [max_by_col(finger_point_pos, 0), max_by_col(finger_point_pos, 1)]
                    max_point_a = [max_by_col(finger_angle_pos, 0), max_by_col(finger_angle_pos, 1)]
                    topLeft = [
                        int(min_point_a[0] if min_point_f[0] > min_point_a[0] else min_point_f[0]),
                        int(min_point_a[1] if min_point_f[1] > min_point_a[1] else min_point_f[1])
                    ]
                    bottomRight = [
                        int(max_point_a[0] if max_point_f[0] < max_point_a[0] else max_point_f[0]),
                        int(max_point_a[1] if max_point_f[1] < max_point_a[1] else max_point_f[1])
                    ]
                    # hand = cropped_img[topLeft[0]:bottomRight[0], topLeft[1]:bottomRight[1]]
                    finger_point_pos = list(map(lambda x: [x[0]-min_point_f[0], x[1]-min_point_f[1]], finger_point_pos))
                    finger_angle_pos = list(map(lambda x: [x[0] - min_point_a[0], x[1] - min_point_a[1]], finger_angle_pos))
                    coords1 = finger_point_pos
                    coords2 = finger_angle_pos
                    while len(coords1) < 7:
                        coords1.append([0, 0])
                    while len(coords2) < 4:
                        coords2.append([0, 0])
                    coords = [
                        coords1[0][0],
                        coords1[0][1],
                        coords1[1][0],
                        coords1[1][1],
                        coords1[2][0],
                        coords1[2][1],
                        coords1[3][0],
                        coords1[3][1],
                        coords1[4][0],
                        coords1[4][1],
                        coords1[5][0],
                        coords1[5][1],
                        coords1[6][0],
                        coords1[6][1],
                        coords2[0][0],
                        coords2[0][1],
                        coords2[1][0],
                        coords2[1][1],
                        coords2[2][0],
                        coords2[2][1],
                        coords2[3][0],
                        coords2[3][1]
                    ]
                    print(neigh.predict([coords]))
                    # print(neigh.predict_proba([coords]))
            cv2.imshow('output', drawing)

    k = cv2.waitKey(5)
    if k == 27 or k == ord('q'):
        csvfile.close()
        break
    elif k == ord('b'):
        bgImg = cropped_img
        isBgCaptured = 1
        print('[INFO] Background Captured')
    elif k == ord('0'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 0, thresh)
        capture += 1
    elif k == ord('1'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 1, thresh)
        capture += 1
    elif k == ord('2'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 2, thresh)
        capture += 1
    elif k == ord('3'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 3, thresh)
        capture += 1
    elif k == ord('4'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 4, thresh)
        capture += 1
    elif k == ord('5'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 5, thresh)
        capture += 1
    elif k == ord('c'):
        save_data(capture, finger_point_pos, finger_angle_pos, csv_wr, 99, thresh)
        capture += 1
    elif k == ord('n'):
        print('[INFO] Background Captured')
    # print (1 / (time.time() - last_time))
    last_time = time.time()

cv2.destroyAllWindows()
camera.release()
